<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta property="og:url" content="https://newzone.top/mianshi/database/redis.html"><meta property="og:site_name" content="IT达摩院"><meta property="og:title" content="Redis 精选面试题🔥"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-20T12:32:59.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Redis"><meta property="article:modified_time" content="2022-11-20T12:32:59.000Z"><title>Redis 精选面试题🔥 | IT达摩院</title><meta name="description" content="个人博客，旨在分享自己的技术">
    <meta name="keywords" content="自我提升,效率提升,开源工具,学习笔记" />
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.d6696c54.css" as="style" /><link rel="stylesheet" href="/assets/style.d6696c54.css" />
    <link rel="modulepreload" href="/assets/app.9106d0d0.js"><link rel="modulepreload" href="/assets/redis.html.baede319.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/redis.html.f07792d0.js">
    <!-- 看板娘区块 -->
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" type="text/css" rel="stylesheet" />
    <script src="/live2d-widget/autoload.js"></script>
    <!-- End 看板娘区块 -->
    <!-- Matomo 此区块为统计代码，请删除-->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://piwik.seoipo.com/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code 此区块为统计代码，请删除-->
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="IT达摩院"><!----><span class="site-name hide-in-pad">IT达摩院</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog.html" class="nav-link" aria-label="博客主页"><span class="icon iconfont icon-home"></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java/" class="nav-link" aria-label="Java"><span class="icon iconfont icon-java"></span>Java<!----></a></div><div class="nav-item hide-in-mobile"><a href="/algorithm/" class="nav-link" aria-label="数据结构算法"><span class="icon iconfont icon-creative"></span>数据结构算法<!----></a></div><div class="nav-item hide-in-mobile"><a href="/spring/" class="nav-link" aria-label="Spring"><span class="icon iconfont icon-leaf"></span>Spring<!----></a></div><div class="nav-item hide-in-mobile"><a href="/springcloud/" class="nav-link" aria-label="SpringCloud学习教程"><span class="icon iconfont icon-cache"></span>SpringCloud学习教程<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="计算机基础"><span class="title"><span class="icon iconfont icon-computer"></span>计算机基础</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/cs/os/" class="nav-link" aria-label="计算机操作系统"><!---->计算机操作系统<!----></a></li><li class="dropdown-item"><a href="/cs/internet/" class="nav-link" aria-label="计算机网络"><!---->计算机网络<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/mianshi/" class="nav-link active" aria-label="面试"><span class="icon iconfont icon-like"></span>面试<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="工具|部署"><span class="title"><span class="icon iconfont icon-operate"></span>工具|部署</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/tools/git.html" class="nav-link" aria-label="Git详解"><!---->Git详解<!----></a></li><li class="dropdown-item"><a href="/tools/linux.md" class="nav-link" aria-label="Linux"><!---->Linux<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><div class="nav-item"><a class="repo-link" href="https://github.com/shenzehui/shenzehui.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/mianshi/" class="nav-link sidebar-link sidebar-page" aria-label="目录"><!---->目录<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Java</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">数据库</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/mianshi/database/theoryandsql.html" class="nav-link sidebar-link sidebar-page" aria-label="数据库原理 精选面试题🔥"><!---->数据库原理 精选面试题🔥<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/mianshi/database/mysql.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL 精选面试题🔥"><!---->MySQL 精选面试题🔥<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/mianshi/database/redis.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Redis 精选面试题🔥"><!---->Redis 精选面试题🔥<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#rbd-和-aof-机制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RBD 和 AOF 机制"><!---->RBD 和 AOF 机制<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#rdb-redis-database" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RDB：Redis DataBase"><!---->RDB：Redis DataBase<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#aof-append-only-file" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AOF：Append Only File"><!---->AOF：Append Only File<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结："><!---->总结：<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-单线程为什么这么快" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 单线程为什么这么快"><!---->Redis 单线程为什么这么快<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-的持久化的机制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 的持久化的机制"><!---->Redis 的持久化的机制<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#rdb-redis-database-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RDB：Redis DataBase"><!---->RDB：Redis DataBase<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#aof-append-only-file-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AOF：Append Only File"><!---->AOF：Append Only File<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-的过期键的删除策略" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 的过期键的删除策略"><!---->Redis 的过期键的删除策略<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-分布式锁底层是如何实现的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 分布式锁底层是如何实现的？"><!---->Redis 分布式锁底层是如何实现的？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-有哪些数据结构-分别有哪些典型的应用场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 有哪些数据结构？分别有哪些典型的应用场景？"><!---->Redis 有哪些数据结构？分别有哪些典型的应用场景？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-主从复制的核心原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 主从复制的核心原理"><!---->Redis 主从复制的核心原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#布隆过滤器原理-优缺点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="布隆过滤器原理，优缺点"><!---->布隆过滤器原理，优缺点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#什么是-redis-为什么用-redis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="什么是 Redis，为什么用 Redis？"><!---->什么是 Redis，为什么用 Redis？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#为什么redis-是单线程的以及为什么这么快" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为什么Redis 是单线程的以及为什么这么快？"><!---->为什么Redis 是单线程的以及为什么这么快？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-一般有哪些使用场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 一般有哪些使用场景"><!---->Redis 一般有哪些使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-有哪些数据类型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 有哪些数据类型？"><!---->Redis 有哪些数据类型？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#谈谈-redis-的对象机制-redisobject" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="谈谈 Redis 的对象机制 （redisObject）?"><!---->谈谈 Redis 的对象机制 （redisObject）?<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-数据类型有哪些底层数据结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 数据类型有哪些底层数据结构？"><!---->Redis 数据类型有哪些底层数据结构？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#为什么要设计sds" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为什么要设计sds？"><!---->为什么要设计sds？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-一个字符串类型的值能存储最大容量是多少" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis 一个字符串类型的值能存储最大容量是多少？"><!---->Redis 一个字符串类型的值能存储最大容量是多少？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#为什么会设计-stream" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为什么会设计 Stream？"><!---->为什么会设计 Stream？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/mianshi/database/redis.html#redis-stream用在什么样场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis Stream用在什么样场景？"><!---->Redis Stream用在什么样场景？<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">开发框架和中间件</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Redis 精选面试题🔥</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://github.com/shenzehui" target="_blank" rel="noopener noreferrer">Marico</a></span><span property="author" content="Marico"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年11月12日</span><meta property="datePublished" content="2022-11-12T12:10:48.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li><span class="category category8" role>面试题</span></li><li><span class="category category6" role>数据库</span></li></ul><meta property="articleSection" content="面试题,数据库"></span><span aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li><span class="tag tag3" role>Redis</span></li></ul><meta property="keywords" content="Redis"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 21 分钟</span><meta property="timeRequired" content="PT21M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#rbd-和-aof-机制" class="router-link-active router-link-exact-active toc-link level2">RBD 和 AOF 机制</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#rdb-redis-database" class="router-link-active router-link-exact-active toc-link level3">RDB：Redis DataBase</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#aof-append-only-file" class="router-link-active router-link-exact-active toc-link level3">AOF：Append Only File</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#总结" class="router-link-active router-link-exact-active toc-link level3">总结：</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-单线程为什么这么快" class="router-link-active router-link-exact-active toc-link level2">Redis 单线程为什么这么快</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-的持久化的机制" class="router-link-active router-link-exact-active toc-link level2">Redis 的持久化的机制</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#rdb-redis-database-1" class="router-link-active router-link-exact-active toc-link level3">RDB：Redis DataBase</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#aof-append-only-file-1" class="router-link-active router-link-exact-active toc-link level3">AOF：Append Only File</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-的过期键的删除策略" class="router-link-active router-link-exact-active toc-link level2">Redis 的过期键的删除策略</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-分布式锁底层是如何实现的" class="router-link-active router-link-exact-active toc-link level2">Redis 分布式锁底层是如何实现的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-有哪些数据结构-分别有哪些典型的应用场景" class="router-link-active router-link-exact-active toc-link level2">Redis 有哪些数据结构？分别有哪些典型的应用场景？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-主从复制的核心原理" class="router-link-active router-link-exact-active toc-link level2">Redis 主从复制的核心原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#布隆过滤器原理-优缺点" class="router-link-active router-link-exact-active toc-link level2">布隆过滤器原理，优缺点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#什么是-redis-为什么用-redis" class="router-link-active router-link-exact-active toc-link level2">什么是 Redis，为什么用 Redis？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#为什么redis-是单线程的以及为什么这么快" class="router-link-active router-link-exact-active toc-link level2">为什么Redis 是单线程的以及为什么这么快？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-一般有哪些使用场景" class="router-link-active router-link-exact-active toc-link level2">Redis 一般有哪些使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-有哪些数据类型" class="router-link-active router-link-exact-active toc-link level2">Redis 有哪些数据类型？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#谈谈-redis-的对象机制-redisobject" class="router-link-active router-link-exact-active toc-link level2">谈谈 Redis 的对象机制 （redisObject）?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-数据类型有哪些底层数据结构" class="router-link-active router-link-exact-active toc-link level2">Redis 数据类型有哪些底层数据结构？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#为什么要设计sds" class="router-link-active router-link-exact-active toc-link level2">为什么要设计sds？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-一个字符串类型的值能存储最大容量是多少" class="router-link-active router-link-exact-active toc-link level2">Redis 一个字符串类型的值能存储最大容量是多少？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#为什么会设计-stream" class="router-link-active router-link-exact-active toc-link level2">为什么会设计 Stream？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/mianshi/database/redis.html#redis-stream用在什么样场景" class="router-link-active router-link-exact-active toc-link level2">Redis Stream用在什么样场景？</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="rbd-和-aof-机制" tabindex="-1"><a class="header-anchor" href="#rbd-和-aof-机制" aria-hidden="true">#</a> RBD 和 AOF 机制</h2><h3 id="rdb-redis-database" tabindex="-1"><a class="header-anchor" href="#rdb-redis-database" aria-hidden="true">#</a> RDB：Redis DataBase</h3><blockquote><p>在指定的时间间隔内将内存中的数据集快照写入磁盘，实际操作过程是 fork 一个子进程，先将数据写入临时文件，写入成功后，再替换之前的文件，用二进制压缩存储。</p></blockquote><ul><li>优点：</li></ul><ol><li><p>整个 Redis 数据库将只包含一个文件 dump.rdb，方便持久化。</p></li><li><p>容灾性好，方便备份。</p></li><li><p>性能最大化，fork 子进程来完成写操作，让主操作继续处理命令，所以是 IO 最大化。使用单独子进程来进行持久化，主进程不会进行任何 IO 操作，保证了 redis 的高性能</p></li><li><p>相对于数据集大时，比 AOF 的启动效率更高。</p></li></ol><ul><li>缺点：</li></ul><ol><li>数据安全性低。RDB 是间隔一段时间进行持久化，如果持久化之间 redis 发生故障，会发生数据丢失。所以这种方式更适合数据要求不严谨的时候</li><li>由于 RDB 是通过 fork 子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫米，甚至是 1 秒中。</li></ol><h3 id="aof-append-only-file" tabindex="-1"><a class="header-anchor" href="#aof-append-only-file" aria-hidden="true">#</a> AOF：Append Only File</h3><blockquote><p>以日志的形式记录服务器所处理的每一个写、删除操作，查询记录不会记录，以文本的方式记录，可以打开文件看到详细的操作记录</p></blockquote><ul><li>优点：</li></ul><ol><li>数据安全，Redis 中提供了3种同步策略，即每秒同步、每修改同步和不同步。事实上，每秒同步也是一步完成的，其效率也是非常高的，所差的是一旦系统出现宕机现象，那么这一秒钟内修改的数据将会丢失。而每修改同步，我们可以将其视为同步持久化，即每次发生的数据变化都会被立即记录到磁盘中。</li><li>通过 append 模式写文件，即使中途服务器宕机也不会破坏已经存在的内容，可以通过 redis-check-aof 工具解决数据一致性问题</li><li>AOF 机制的 rewrite 模式。定期对 AOF 文件进行重写，以达到压缩的目的。</li></ol><ul><li>缺点：</li></ul><ol><li>AOF 文件比 RDB 文件大，且恢复速度慢。</li><li>数据集大的时候，比 rdb 启动效率低。</li><li>运行效率没有 RBD 高</li></ol><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结：</h3><ol><li><p>AOF 文件比 RDB 更新频率高，优先使用 AOF 还原数据。</p></li><li><p>AOF 比 RDB 更安全也更大</p></li><li><p>RBD 性能比 AOF好</p></li><li><p>如果两个都配置了，优先加载 AOF 文件</p></li></ol><h2 id="redis-单线程为什么这么快" tabindex="-1"><a class="header-anchor" href="#redis-单线程为什么这么快" aria-hidden="true">#</a> Redis 单线程为什么这么快</h2><p>Redis 基于 Reactor 模式开发了网络事件处理器、文件事件处理器 file event handler。它是单线程的，所以 Redis 才叫做单线程模型，它采用 IO 多路复用机制来监听多个 Socket，根据 Socket 上的事件类型来选择对应的事件处理器来处理这个事件。可以实现高性能的网络通信模型，又可以跟内部其他单线程的模块进行对接，保证了 Redis 内部的线程模型的简单性。</p><p><strong>文件事件处理器</strong>的结构包含4个部分：<code>多个 Socket、IO多路复用程序、文件事件分派器以及事件处理器</code>（命令请求处理器、命令回复处理器、连接应答处理器等）。</p><p>多个 Socket 可能并发的产生不同的事件，IO多路复用程序会监听多个 Socket，会将 <code>Socket</code> 放入一个队列排队，每次，每次从队列中有序、同步取出一个 Socket 给<code>事件分派器</code>，事件分派器把 Socket 给对应的<code>事件处理器</code>。然后一个 Socket 的事件处理完成之后，IO 多路复用程序才会将队列中的下一个 Socket 给事件分派器。文件事件分派器会根据每个 Socket 当期产生的事件，来选择对应的时间处理器来处理。</p><ol><li>Redis 启动初始化时，将连接应答处理器跟 AE_READABLE 事件关联。</li><li>若一个客户端发起连接，会产生一个 AE_READABLE 事件，然后由连接应答处理器负责和客户端建立连接，创建客户端对应的 socket，同时将这个 socket 的 AE_READABLE 事件和命令请求处理器关联，使得客户端可以向主服务器发送命令请求。</li><li>当客户端向 Redis 发请求时（不管读还是写请求），客户端 socket 都会产生一个 AE_READABLE 事件，触发命令请求处理器，处理器读取客户端的命令内容，然后传给相关程序执行。</li><li>当 Redis 服务器准备好给客户端的响应数据后，会将 socket 的 AE_WRITABLE 事件和命令回复处理器关联，当客户端准备好读取响应数据时，会在 socket 产生一个 AE_WRITABLE 事件，由对应命令回复处理器处理，即将准备好的数据写入 socket，供客户端读取。</li><li>命令回复处理器全部写完到 socket 后，就会删除该 socket 的 AE_WRITABLE 事件和命令回复处理器的映射。</li></ol><p><strong>单线程快的原因：</strong></p><ol><li>纯内存操作（不需要进行 CPU 的切换）</li><li>核心是基于非阻塞 IO 和多路复用机制</li><li>单线程反而避免了多线程的的频繁切换上下文带来的性能问题</li></ol><h2 id="redis-的持久化的机制" tabindex="-1"><a class="header-anchor" href="#redis-的持久化的机制" aria-hidden="true">#</a> Redis 的持久化的机制</h2><h3 id="rdb-redis-database-1" tabindex="-1"><a class="header-anchor" href="#rdb-redis-database-1" aria-hidden="true">#</a> RDB：Redis DataBase</h3><blockquote><p>将某一个时刻的内存快照（Snapshot），以二进制的方式写入磁盘。</p></blockquote><p><strong>手动触发：</strong></p><ul><li>save 命令，使 Redis 处于阻塞状态，直到 RDB 持久化完成，才会响应其他客户端发来的命令，所以在生产环境一定要慎用</li><li>bgsave 命令，fork 出一个子进程执行持久化，主进程只在 fork 过程中有短暂的阻塞，主进程就可以响应客户端请求了</li></ul><p><strong>自动触发：</strong></p><ul><li>save m n：在 m 秒内，如果有 n 个键发生改变，则自动触发持久化，通过 bgsave 执行，如果设置多个、只要满足其一就会触发，配置文件有默认配置（可以注释调掉）</li><li>flushall：用于清空 redis 所有的数据库，flushdb 清空当期 redis 所在库数据（默认是 0 号数据库），会清空 RDB 文件，同时也会生成 dump.rdb，内容为空</li><li>主从同步：全量同步时会自动触发 bgsave 命令，生成 rdb 发送给从节点</li></ul><p><strong>优点：</strong></p><ol><li><p>整个 Redis 数据库将只包含一个文件 dump.rdb，方便持久化。</p></li><li><p>容灾性好，方便备份。</p></li><li><p>性能最大化，fork 子进程来完成写操作，让主操作继续处理命令，所以是 IO 最大化。使用单独子进程来进行持久化，主进程不会进行任何 IO 操作，保证了 redis 的高性能</p></li><li><p>相对于数据集大时，比 AOF 的启动效率更高。</p></li></ol><p><strong>缺点：</strong></p><ol><li>数据安全性低。RDB 是间隔一段时间进行持久化，如果持久化之间 redis 发生故障，会发生数据丢失。所以这种方式更适合数据要求不严谨的时候</li><li>由于 RDB 是通过 fork 子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫米，甚至是 1 秒中，会占用 cpu。</li></ol><h3 id="aof-append-only-file-1" tabindex="-1"><a class="header-anchor" href="#aof-append-only-file-1" aria-hidden="true">#</a> AOF：Append Only File</h3><blockquote><p>以日志的形式记录服务器所处理的每一个写、删除操作，查询记录不会记录，以文本的方式记录，可以打开文件看到详细的操作记录，调操作系统命令进程刷盘</p></blockquote><ol><li>所有的写命令会追加到 AOF 缓冲中。</li><li>AOF 缓冲区根据对应的策略向硬盘进行同步操作</li><li>随着 AOF 文件越来越大，需要定期对 AOF 文件进行重写，达到压缩的目的。</li><li>当 Redis 重启时，可以加载 AOF 文件进行数据恢复</li></ol><p><strong>同步策略：</strong></p><ul><li>每秒同步：异步完成，效率非常高，一旦系统出现宕机现象，那么这一秒钟之内修改的数据将会丢失。</li><li>每修改同步：同步持久化，每次发生的数据变化都会被立即记录到磁盘中，最多丢一条</li><li>不同步：由操作系统控制，可能丢失较多数据</li></ul><p><strong>优点：</strong></p><ol><li>数据安全</li><li>通过 append 模式写文件，即使中途服务器宕机也不会破坏已经存在的内容，可以通过 redis-check-aof 工具解决一致性问题。</li><li>AOF 机制的 rewrite 模式。定期对 AOF 文件进行重写，已达到压缩的目的</li></ol><p><strong>缺点：</strong></p><ol><li>AOF 文件比 RDB 文件大，且恢复速度慢。</li><li>数据集大的时候，比 rdb 启动效率低。</li><li>运行效率没有 RBD 高</li></ol><p>AOF 文件比 RDB 更新频率高，优先使用 AOF 还原数据。</p><p>AOF 比 RDB 更安全也更大</p><p>RBD 性能比 AOF好</p><p>如果两个都配置了，优先加载 AOF 文件</p><h2 id="redis-的过期键的删除策略" tabindex="-1"><a class="header-anchor" href="#redis-的过期键的删除策略" aria-hidden="true">#</a> Redis 的过期键的删除策略</h2><p>Redis 是 key-value 数据库，我们可以设置 Redis 中缓存的 key 的过期时间。Redis 的过期策略就是指定当 Redis 中缓存的 key 过期了，Redis 如何处理。</p><ul><li>惰性过期：只有当访问一个 key 时，才会判断 key 是否已过期，过期则删除。该策略可以最大化地节省 CPU 资源，却对内存非常不友好。极端情况可能出现大量的 key 没有再次被访问，从而不会被清除，占用大量内存。</li><li>定期过期：每隔一定的时间，会扫描一定数量的数据库的 expires 字典中一定数量的 key，并清除其中已过期的 key。该策略是前两者的一个折中方案。通过调整定时扫描的时间间隔和每次扫描的限定耗时，可以在不同情况下使得 CPU 和 内存资源达到最优的平衡效果。</li></ul><p>(expries 字典会保存所有设置了过期时间的 key 的过期时间数据，其中，key 是指向键空间中的某个键的指针，value 是该键的毫秒精度的 UNIX 时间戳表示的过期时间。键空间是指该 Redis 集群中保存的所有键。)</p><p>Redis 中同时使用了惰性过期和定期过期两种过期策略。</p><h2 id="redis-分布式锁底层是如何实现的" tabindex="-1"><a class="header-anchor" href="#redis-分布式锁底层是如何实现的" aria-hidden="true">#</a> Redis 分布式锁底层是如何实现的？</h2><ol><li>首先利用 setnx 来保证：如果 key 不存在才能获取到锁，如果 key 存在，则获取不到锁</li><li>然后还要利用 lua 脚本来保证多个 redis 操作的原子性</li><li>同时还要考虑到锁过期，所以需要额外的一个看门狗定时任务来监听锁是否需要续约</li><li>同时还要考虑到 redis 节点挂掉之后的情况，所以需要采用红锁的方式来同时向 N/2 +1 个节点申请锁，都申请到了才证明获取锁成功，这样就算其中某个 redis 节点挂掉了，锁也不会被其他客户端获取到。</li></ol><h2 id="redis-有哪些数据结构-分别有哪些典型的应用场景" tabindex="-1"><a class="header-anchor" href="#redis-有哪些数据结构-分别有哪些典型的应用场景" aria-hidden="true">#</a> Redis 有哪些数据结构？分别有哪些典型的应用场景？</h2><p>Redis 的数据结构有：</p><ol><li>字符串：可以用来做简单的数据，可以缓存某个简单的字符串，也可以缓存某个 json 格式的字符串，Redis 分布式锁的实现就利用了这种数据结构，还包括可以实现计数器、Session 共享、分布式 ID</li><li>哈希表：可以用来存储一些 key-value 对，更适合用来存储对象</li><li>列表：Redis 的列表通过命令的组合，既可以当做栈，也可以当做队列来使用，可以用来缓存类似微信公众号、微博等消息流数据</li><li>集合：和列表相似，也可以存储多个元素，但是不能重复，集合可以进行交集、并集、差集等操作，从而可以实现类似我和某人共同关注的人、朋友圈点赞等功能</li><li>有序集合：集合是无序的，有序集合可以设置顺序，可以用来实现排行榜功能</li></ol><h2 id="redis-主从复制的核心原理" tabindex="-1"><a class="header-anchor" href="#redis-主从复制的核心原理" aria-hidden="true">#</a> Redis 主从复制的核心原理</h2><p>通过执行 salveof 命令设置 slaveof 选项，让一个服务器去复制另一个服务器的数据。主数据库可以进行读写操作，当写操作导致数据变化时会自动将数据同步给从数据库。而从数据库一般是只读的，并接受主数据库同步过来的数据。一个主数据库可以拥有多个从数据库，而一个从数据库只能拥有一个主数据库。</p><p><strong>全量复制：</strong></p><p>（1）主节点通过 bgsave 命令 fork 子进程进行 RDB 持久化（生成全量数据快照），该过程非常消耗 CPU、内存（页表复制）、硬盘 IO等</p><p>（2）主节点通过网络将 RDB 文件发送给从节点，对主从节点的贷款都会带来很大的消耗</p><p>（3）从节点清空老数据、载入新 RDB 文件的过程是阻塞的，无法响应客户端；如果从节点执行 bgrewriteof，也会带来额外的消耗</p><p><strong>部分复制：</strong></p><ul><li>复制偏移量：执行复制的双方，主从节点，分别会维护一个复制偏移量 offset</li><li>复制积压缓冲区：<strong>主节点内部维护了一个固定长度的、先进先出（FIFO）队列</strong>作为复制积压缓冲区，当主从节点 offset 的差距过大超过缓冲区的长度时，将无法执行部分复制，只能执行全量复制。</li><li>服务器运行 ID（runid）：每个 Redis 节点，都有其运行 ID，运行 ID 由节点在启动时自动生成，主节点会将自己的运行 ID 发送给从节点，从节点会将主节点的运行 ID 存起来。从节点 Redis 断开重连的时候，就是根据运行 ID 来判断同步的进度： <ul><li>如果从节点保存的 runid 与 主节点现在的 runid 相同，说明主从节点之前同步过，主节点会继续尝试使用使用部分复制（到底能不能部分复制还要看 offset 和复制积压缓冲区的情况）；</li><li>如果从节点保存的 runid 与主节点现在的 runid 不同，说明从节点在断线前同步的 Redis 节点并不是当前的主节点，只能进行全量复制。</li></ul></li></ul><p>过程原理：</p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/image-20221112190247115.png" alt="image-20221112190247115" loading="lazy"></p><h2 id="布隆过滤器原理-优缺点" tabindex="-1"><a class="header-anchor" href="#布隆过滤器原理-优缺点" aria-hidden="true">#</a> 布隆过滤器原理，优缺点</h2><p>位图：int[10]，每个 int 类型的整数是 4*8 = 32 个 bit，则 int[10] 一共有 320 bit，每个 bit 非0 即 1，初始化时都是 0。添加数据时，将数据进行 hash 得到 hash 值，对应到 bit 为，将 bit 改为 1，hash 函数可以定义多个，则一个数据添加将多个（hash 函数个数）bit 改为 1，多个 hash 函数的目的是减少 hash 碰撞的概率</p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/20210225103955320.png" alt="" loading="lazy"></p><p>查询数据：hash 函数计算得到 hash 值，对应到 bit 中，如果有一个为 0，则说明数据不在 bit 中，如果都为 1，则该数据可能在 bit 中</p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/20210225105747809.png" alt="img" loading="lazy"></p><p><strong>优点：</strong></p><ul><li>占用内存小</li><li>增加和查询元素的时间复杂度为：O(K)，（K为哈希函数的个数，一般比较小），与数据量大小无关</li><li>哈希函数互相之间没有关系，方便硬件并行计算</li><li>布隆过滤器不需要存储元素本身，在某些对保密要求比较严格的场合有很大优势</li><li>数据量大时，布隆过滤器可以表示全集</li><li>使用同一组散列函数的布隆过滤器可以进行交、并、差运算</li></ul><p><strong>缺点：</strong></p><ul><li>误判率，即存在假阳性（False Position），不能准确判断元素是否在集合中</li><li>不能获取元素本身</li><li>一般情况下不能从布隆过滤器中删除元素</li></ul><h2 id="什么是-redis-为什么用-redis" tabindex="-1"><a class="header-anchor" href="#什么是-redis-为什么用-redis" aria-hidden="true">#</a> 什么是 Redis，为什么用 Redis？</h2><p>Redis 是一种支持 key-value 等多种数据结构的存储系统。可用于缓存，事件发布或订阅，高速队列等场景。支持网络，提供字符串，哈希，列表，队列，集合结构直接存取，基于内存，可持久化。</p><ul><li><strong>读写性能优异</strong><ul><li>Redis 能读的速度是 110000 次/s，写的速度是 81000 次/s</li></ul></li><li><strong>数据类型丰富</strong><ul><li>Redis 支持二进制案例的 Strings，Lists，Hashes，Sets 及 Ordered Sets 数据类型凑哦。</li></ul></li><li><strong>原子性</strong><ul><li>Redis 的所有操作都是原子性的，同时 Redsi 还支持对几个操作全并后的原子性操作。</li></ul></li><li><strong>丰富的特性</strong><ul><li>Redis 支持 publish/subscribe，通知，key 过期等特性</li></ul></li><li><strong>持久化</strong><ul><li>Redis 支持 RDB，AOF 等持久化方式</li></ul></li><li><strong>发布订阅</strong><ul><li>Redis 支持发布/订阅模式</li></ul></li><li><strong>分布式</strong><ul><li>Redis Cluster</li></ul></li></ul><h2 id="为什么redis-是单线程的以及为什么这么快" tabindex="-1"><a class="header-anchor" href="#为什么redis-是单线程的以及为什么这么快" aria-hidden="true">#</a> 为什么Redis 是单线程的以及为什么这么快？</h2><ul><li>redis 完全基于内存，绝大部分请求是纯粹的内存操作，非常快速</li><li>数据结构简单，对数据操作也简单，redis 中的数据结构是专门进行设计的</li><li>采用单线程模型，避免了不必要的上下文切换和竞争条件，也不存在多线程或者多线程切换而消耗 CPU，不用考虑各种锁的问题，不存在加锁，释放锁的操作，没有因为可能出现死锁而导致性能消耗</li><li>使用了多路 IO 复用模型，非阻塞 IO</li><li>使用底层模型不同，它们之间底层实现方式及与客户端之间的，通信的应用协议不一样，Redis 直接构建了自己的 VM 机制，因为一般的系统调用函数的话，会浪费一定的时间去移动和请求</li></ul><h2 id="redis-一般有哪些使用场景" tabindex="-1"><a class="header-anchor" href="#redis-一般有哪些使用场景" aria-hidden="true">#</a> Redis 一般有哪些使用场景</h2><p>可以结合自己的项目讲讲，比如</p><ul><li><strong>热点数据的缓存</strong></li></ul><p>缓存是 Redis 最常见的应用场景，之所以这么使用，主要是因为 Redis 读写性能优越，而且逐渐有取代 memcached，成为首选服务端缓存的组件。而且，Redis 内部是支持事务的，在使用的时候能有效保证数据的一致性。</p><ul><li><strong>限时业务的应用</strong></li></ul><p>redis 中可以使用 expire 命令设置一个键的生存时间，到时间后 redis 会删除它。利用这一特性可以运用显示的优惠活动信息、手机验证码等业务场景。</p><ul><li><strong>计数器相关问题</strong></li></ul><p>redis 由于 incrby 命令可以实现原子性的递增，所以可以运用高并发的秒杀活动、分布式序列号的生产、具体业务还体现在比如限制一个手机号发多少短信，一个接口一分钟限制多少请求、一个接口一天限制调用多少次等等。</p><ul><li><strong>分布式锁</strong></li></ul><p>这个主要利用 redis 的 setnx 命令进行，setnx：&quot;set if not exists&quot; 就是如果不存在则成功设置缓存同时返回1，否则返回0，这个特性在 XXX 后台中有所应用，因为我们的服务器是集群的，定时任务可能在两台机器上都会进行，所以在定义任务中首先通过 sestnx 设置一个 lock，如果成功设置则执行，如果没有设置成功，则表明该定时任务已执行。当然结合具体业务，我们可以给这个 lock 加一个过期时间，比如说 30 分钟执行一次定义任务，那么这个过期时间设置小于 30 分钟的一个时间就可以，这个与定义任务的周期以及定时任务执行消耗时间有关。</p><p>在分布式锁的场景中，主要用在比如秒杀系统等。</p><h2 id="redis-有哪些数据类型" tabindex="-1"><a class="header-anchor" href="#redis-有哪些数据类型" aria-hidden="true">#</a> Redis 有哪些数据类型？</h2><ul><li><strong>5种基础数据类型</strong>，分别是：String、List、Set、Zset、Hash。</li></ul><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/image-20221120183505742.png" alt="image-20221120183505742" loading="lazy"></p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/image-20221120183634932.png" alt="" loading="lazy"></p><ul><li><strong>三种特殊的数据类型</strong> 分别是 HyperLogLogs（基数统计），Bitmaps（位图） 和 geospatial （地理位置)</li></ul><h2 id="谈谈-redis-的对象机制-redisobject" tabindex="-1"><a class="header-anchor" href="#谈谈-redis-的对象机制-redisobject" aria-hidden="true">#</a> 谈谈 Redis 的对象机制 （redisObject）?</h2><p>比如说，集合类型就可以由字典和整数集合两种不同的数据结构实现，但是，当用户执行 ZADD 命令时，用户应该不必关心集合使用的是什么编码，只要 Redis 能按照 ZADD 命令的指令，将新元素添加到集合就可以了。</p><p>这说明，<strong>操作数据类型的命令处理要对键的类型进行检查之外，还需要根据数据类型的不同编码进行多态处理</strong></p><p>为了解决以上问题，<strong>Redis 构建了自己的类型系统</strong>，这个系统的主要功能包括：</p><ul><li>redisObject 对象</li><li>基于 redisObject 对象的类型检查</li><li>基于 redisObject 对象的显式多态函数</li><li>对 redisObject 进行分配、共享和销毁机制</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">/*
 * Redis 对象
 */</span>
typedef struct redisObject <span class="token punctuation">{</span>
    <span class="token comment">// 类型</span>
    unsigned type<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>

    <span class="token comment">// 编码方式</span>
    unsigned encoding<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>

    <span class="token comment">// LRU - 24位, 记录最末一次访问时间（相对于lru_clock）; 或者 LFU（最少使用的数据：8位频率，16位访问时间）</span>
    unsigned lru<span class="token operator">:</span><span class="token constant">LRU_BITS</span><span class="token punctuation">;</span> <span class="token comment">// LRU_BITS: 24</span>

    <span class="token comment">// 引用计数</span>
    <span class="token keyword">int</span> refcount<span class="token punctuation">;</span>

    <span class="token comment">// 指向底层数据结构实例</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>

<span class="token punctuation">}</span> robj<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下图对应上面的结构</p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/image-20221120202531592.png" alt="image-20221120202531592" loading="lazy"></p><h2 id="redis-数据类型有哪些底层数据结构" tabindex="-1"><a class="header-anchor" href="#redis-数据类型有哪些底层数据结构" aria-hidden="true">#</a> Redis 数据类型有哪些底层数据结构？</h2><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/7b6099bbb0bf4c269f968e9dea1faff2.png" alt="" loading="lazy"></p><ul><li>简单动态字符串 - sds</li><li>压缩列表 - ZipList</li><li>快表 - QuickList</li><li>字典/哈希表 - Dict</li><li>整数集 - IntSet</li><li>跳表 - ZSkipList</li></ul><h2 id="为什么要设计sds" tabindex="-1"><a class="header-anchor" href="#为什么要设计sds" aria-hidden="true">#</a> 为什么要设计sds？</h2><ul><li><strong>常数复杂度获取字符串长度</strong></li></ul><p>由于 len 属性的存在，我们获取 SDS 字符串的长度只需要读取 len 属性，时间复杂度为 O(1)。而对于 C 语言，获取字符串的长度通常是经过遍历计数来实现的，时间复杂度为 O(n)。通过 <code>strlen key</code> 命令可以获取 key 的字符串长度。</p><ul><li><strong>杜绝缓冲区溢出</strong></li></ul><p>我们知道在 C 语言中使用 <code>strcat</code> 函数来进行两个字符串的拼接，一旦没有分配足够长度的内存空间，就会造成缓冲区溢出。而对于 SDS 数据类型，在进行字符修改的时候，<strong>会首先根据记录的 len 属性检查内存空间是否满足需求</strong>，如果不满足，会进行相应的空间扩展，然后在进行修改操作，所以不会出现缓冲区溢出。</p><ul><li><strong>减少修改字符串的内存重新分配次数</strong></li></ul><p>C语言由于不记录字符串的长度，所以如果要修改字符串，必须要重新分配内存（先释放再申请），因为如果没有重新分配，字符串长度增大时会造成内存缓冲区溢出，字符串长度减小时会造成内存泄露。</p><p>而对于SDS，由于<code>len</code>属性和<code>alloc</code>属性的存在，对于修改字符串SDS实现了<strong>空间预分配</strong>和<strong>惰性空间释放</strong>两种策略：</p><ol><li><strong>空间预分配</strong>：对字符串进行空间扩展的时候，扩展的内存比实际需要的多，这样可以减少连续执行字符串增长操作所需的内存重分配次数。</li><li><strong>惰性空间释放</strong>：对字符串进行缩短操作时，程序不立即使用内存重新分配来回收缩短后多余的字节，而是使用 <code>alloc</code> 属性将这些字节的数量记录下来，等待后续使用。（当然SDS也提供了相应的API，当我们有需要时，也可以手动释放这些未使用的空间。）</li></ol><ul><li><strong>二进制安全</strong></li></ul><p>因为C字符串以空字符作为字符串结束的标识，而对于一些二进制文件（如图片等），内容可能包括空字符串，因此C字符串无法正确存取；而所有 SDS 的API 都是以处理二进制的方式来处理 <code>buf</code> 里面的元素，并且 SDS 不是以空字符串来判断是否结束，而是以 len 属性表示的长度来判断字符串是否结束。</p><ul><li><strong>兼容部分 C 字符串函数</strong></li></ul><p>虽然 SDS 是二进制安全的，但是一样遵从每个字符串都是以空字符串结尾的惯例，这样可以重用 C 语言库<code>&lt;string.h&gt;</code> 中的一部分函数。</p><h2 id="redis-一个字符串类型的值能存储最大容量是多少" tabindex="-1"><a class="header-anchor" href="#redis-一个字符串类型的值能存储最大容量是多少" aria-hidden="true">#</a> Redis 一个字符串类型的值能存储最大容量是多少？</h2><p><strong>512M</strong></p><h2 id="为什么会设计-stream" tabindex="-1"><a class="header-anchor" href="#为什么会设计-stream" aria-hidden="true">#</a> 为什么会设计 Stream？</h2><p>用过 Redis 做消息队列的都了解，基于 Redis 的消息队列实现有很多种，例如：</p><ul><li><strong>PUB/SUB，订阅/发布模式</strong><ul><li>但是发布订阅模式是无法持久化的，如果出现网络断开，Redis 宕机等，消息就会被丢弃；</li></ul></li><li>基于 Lsit LPUSH + BRPOP 或者 <strong>基于 Sorted-Set</strong> 的实现</li></ul><p><strong>消息组消费图</strong></p><p><img src="https://cdn.jsdelivr.net/gh/itmarico/image-repository/img/image-20221120202321825.png" alt="image-20221120202321825" loading="lazy"></p><h2 id="redis-stream用在什么样场景" tabindex="-1"><a class="header-anchor" href="#redis-stream用在什么样场景" aria-hidden="true">#</a> Redis Stream用在什么样场景？</h2></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/shenzehui/shenzehui.github.io/edit/main/docs/mianshi/database/redis.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次更新: </span><!----></div><!----></footer><nav class="page-nav"><a href="/mianshi/database/mysql.html" class="nav-link prev" aria-label="MySQL 精选面试题🔥"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->MySQL 精选面试题🔥</div></a><!----></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://beian.miit.gov.cn/" target="_blank">豫ICP备2021038026号-1</a></div><div class="copyright">Copyright © 2022 Marico</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.9106d0d0.js" defer></script>
  </body>
</html>
